{% extends "base_layout.html" %}

{% block base_top_scripts %}

{% endblock %}

{% block title %}
    Show recipe
{% endblock %}

{% block main %}
<div class="grid">
    <!-- Heading -->
    <div class="row">
        <div class="cell">
            <h1 class="text-center">{{ name }}</h1>
        </div>
    </div>
    <!-- Middle row with inputs -->
    <div class="row">
        <!-- Left side, difficulty, taste and time and steps -->
        <div class="cell">
            <!-- difficulty, taste and time indicators -->
            <div class="row">
                <div class="cell">
                    <div class="form-group">
                        <label>Difficulty</label>
                        <input type="text" data-role="spinner" data-min-value="1" data-max-value="5" name="difficulty">
                    </div>
                </div>
                <div class="cell">
                    <div class="form-group">
                        <label>Taste</label>
                        <input type="text" data-role="spinner" data-min-value="1" data-max-value="5" name="taste">
                    </div>
                </div>
                <div class="cell">
                    <div class="form-group">
                        <label>Time</label>
                        <input data-role="timepicker" data-seconds="false" data-value="00:00" name="time">
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="cell">
                    <ul id="recipeStepList" class="step-list">
                    </ul>
                </div>
            </div>
        </div>
        <!-- Right side with preps and ingredients -->
        <div class="cell">
            <div class="row">
                <div class="cell">
                    <h1 class="text-center">Preparations</h1>
                    <ul id="prep_ul" class="items-list">
                    </ul>
                </div>
            </div>
            <div class="row">
                <div class="cell">
                    <h1 class="text-center">Ingredients</h1>
                    <ul id="ingredient_ul" class="items-list">
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block base_bottom_scripts %}
<script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script type="text/javascript" src="{{url_for('static', filename='scripts/list_actions.js')}}"></script>
<script type="text/javascript" src="{{url_for('static', filename='scripts/elements.js')}}"></script>
<script type="text/javascript">
    function add_ingredients(){
        let ingredients_array = {{ ingredients|safe }};
        console.log("Ingredients: ");
        console.log(ingredients_array);
    }

    function add_steps(){
        let steps_array = {{ steps|safe }};
        console.log(steps_array)
        console.log(steps_array.length)
        for (let i = 0; i < steps_array.length; i++){
            let element = document.createElement("li");
            let heading = create_heading_tag("h1", i);

            let content = document.createElement("p");
            content.textContent = steps_array[i];

            element.appendChild(heading);
            element.appendChild(content);

            $("#recipeStepList").append(element);
        }
    }

    function add_preps(){
        // Create an array from the jinja parameter preps
        // Using safe-filter to make sure the data is not HTML-escaped.
        preps_array = {{ preps|safe }};

        // For each item in the array, add it to preps list.
        // No remove-button should be used.
        preps_array.forEach(function(prep){
            element = create_list_item(
                [{"label":prep}],
                remove_button=false
            );
            $("#prep_ul").append(element);
        })
    }

    function add_statusbar(){
        difficulty = {{ difficulty|safe }};
        taste = {{ taste|safe }};
        time = "{{ time|safe }}";
        console.log("Statuses: ");
        console.log(difficulty, taste, time);
    }

    add_ingredients();
    add_steps();
    add_preps();
    add_statusbar();
</script>
{% endblock %}
